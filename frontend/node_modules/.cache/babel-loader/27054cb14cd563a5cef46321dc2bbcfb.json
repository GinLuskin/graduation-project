{"ast":null,"code":"import _slicedToArray from\"/Users/reginaluskin/Desktop/Graduation-Project/GraduationProject/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback,useEffect}from'react';var logoutTimer;export var useAuth=function useAuth(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),tokenExpirationDate=_useState4[0],setTokenExpirationDate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var login=useCallback(function(uid,token,expirationDate){setToken(token);setUserId(uid);var tokenExpirationDate=expirationDate||new Date(new Date().getTime()+1000*60*60);setTokenExpirationDate(tokenExpirationDate);localStorage.setItem('userData',JSON.stringify({userId:uid,token:token,expiration:tokenExpirationDate.toISOString()}));},[]);var logout=useCallback(function(){setToken(null);setTokenExpirationDate(null);setUserId(null);localStorage.removeItem('userData');},[]);useEffect(function(){if(token&&tokenExpirationDate){var remainingTime=tokenExpirationDate.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,tokenExpirationDate]);useEffect(function(){var storedData=JSON.parse(localStorage.getItem('userData'));if(storedData&&storedData.token&&new Date(storedData.expiration)>new Date()){login(storedData.userId,storedData.token,new Date(storedData.expiration));}},[login]);return{token:token,login:login,logout:logout,userId:userId};};","map":{"version":3,"names":["useState","useCallback","useEffect","logoutTimer","useAuth","token","setToken","tokenExpirationDate","setTokenExpirationDate","userId","setUserId","login","uid","expirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem"],"sources":["/Users/reginaluskin/Desktop/Graduation-Project/GraduationProject/src/shared/hooks/auth-hook.js"],"sourcesContent":["import { useState, useCallback, useEffect} from 'react';\n\nlet logoutTimer;\n\nexport const useAuth = () => {\n\n  const [token, setToken] = useState(false);\n  const [tokenExpirationDate, setTokenExpirationDate] = useState();\n  const [userId, setUserId] = useState(false);\n\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    const tokenExpirationDate =\n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationDate(tokenExpirationDate);\n    localStorage.setItem(\n      'userData',\n      JSON.stringify({\n        userId: uid,\n        token: token,\n        expiration: tokenExpirationDate.toISOString()\n      })\n    );\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null);\n    setTokenExpirationDate(null);\n    setUserId(null);\n    localStorage.removeItem('userData');\n  }, []);\n\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime = tokenExpirationDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]);\n\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem('userData'));\n    if (\n      storedData &&\n      storedData.token &&\n      new Date(storedData.expiration) > new Date()\n    ) {\n      login(storedData.userId, storedData.token, new Date(storedData.expiration));\n    }\n  }, [login]);\n\n  return {token, login, logout, userId};\n};"],"mappings":"mJAAA,OAASA,QAAQ,CAAEC,WAAW,CAAEC,SAAS,KAAO,OAAO,CAEvD,GAAIC,YAAW,CAEf,MAAO,IAAMC,QAAO,CAAG,QAAVA,QAAO,EAAS,CAE3B,cAA0BJ,QAAQ,CAAC,KAAK,CAAC,wCAAlCK,KAAK,eAAEC,QAAQ,eACtB,eAAsDN,QAAQ,EAAE,yCAAzDO,mBAAmB,eAAEC,sBAAsB,eAClD,eAA4BR,QAAQ,CAAC,KAAK,CAAC,yCAApCS,MAAM,eAAEC,SAAS,eAExB,GAAMC,MAAK,CAAGV,WAAW,CAAC,SAACW,GAAG,CAAEP,KAAK,CAAEQ,cAAc,CAAK,CACxDP,QAAQ,CAACD,KAAK,CAAC,CACfK,SAAS,CAACE,GAAG,CAAC,CACd,GAAML,oBAAmB,CACvBM,cAAc,EAAI,GAAIC,KAAI,CAAC,GAAIA,KAAI,EAAE,CAACC,OAAO,EAAE,CAAG,IAAI,CAAG,EAAE,CAAG,EAAE,CAAC,CACnEP,sBAAsB,CAACD,mBAAmB,CAAC,CAC3CS,YAAY,CAACC,OAAO,CAClB,UAAU,CACVC,IAAI,CAACC,SAAS,CAAC,CACbV,MAAM,CAAEG,GAAG,CACXP,KAAK,CAAEA,KAAK,CACZe,UAAU,CAAEb,mBAAmB,CAACc,WAAW,EAC7C,CAAC,CAAC,CACH,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,GAAMC,OAAM,CAAGrB,WAAW,CAAC,UAAM,CAC/BK,QAAQ,CAAC,IAAI,CAAC,CACdE,sBAAsB,CAAC,IAAI,CAAC,CAC5BE,SAAS,CAAC,IAAI,CAAC,CACfM,YAAY,CAACO,UAAU,CAAC,UAAU,CAAC,CACrC,CAAC,CAAE,EAAE,CAAC,CAENrB,SAAS,CAAC,UAAM,CACd,GAAIG,KAAK,EAAIE,mBAAmB,CAAE,CAChC,GAAMiB,cAAa,CAAGjB,mBAAmB,CAACQ,OAAO,EAAE,CAAG,GAAID,KAAI,EAAE,CAACC,OAAO,EAAE,CAC1EZ,WAAW,CAAGsB,UAAU,CAACH,MAAM,CAAEE,aAAa,CAAC,CACjD,CAAC,IAAM,CACLE,YAAY,CAACvB,WAAW,CAAC,CAC3B,CACF,CAAC,CAAE,CAACE,KAAK,CAAEiB,MAAM,CAAEf,mBAAmB,CAAC,CAAC,CAExCL,SAAS,CAAC,UAAM,CACd,GAAMyB,WAAU,CAAGT,IAAI,CAACU,KAAK,CAACZ,YAAY,CAACa,OAAO,CAAC,UAAU,CAAC,CAAC,CAC/D,GACEF,UAAU,EACVA,UAAU,CAACtB,KAAK,EAChB,GAAIS,KAAI,CAACa,UAAU,CAACP,UAAU,CAAC,CAAG,GAAIN,KAAI,EAAE,CAC5C,CACAH,KAAK,CAACgB,UAAU,CAAClB,MAAM,CAAEkB,UAAU,CAACtB,KAAK,CAAE,GAAIS,KAAI,CAACa,UAAU,CAACP,UAAU,CAAC,CAAC,CAC7E,CACF,CAAC,CAAE,CAACT,KAAK,CAAC,CAAC,CAEX,MAAO,CAACN,KAAK,CAALA,KAAK,CAAEM,KAAK,CAALA,KAAK,CAAEW,MAAM,CAANA,MAAM,CAAEb,MAAM,CAANA,MAAM,CAAC,CACvC,CAAC"},"metadata":{},"sourceType":"module"}